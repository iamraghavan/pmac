{% extends "base.html" %}
{% block title %}{{ title }}{% endblock %}

{% block content %}
{% include 'components/navbar.html' %}

<div id="main">
    <header class="mb-3">
        <a href="#" class="burger-btn d-block d-xl-none">
            <i class="bi bi-justify fs-3"></i>
        </a>
    </header>

    <div class="page-heading">
        <div class="page-title">
            <div class="row">
                <div class="col-12 col-md-6 order-md-1 order-last">
                    <h3>Profile View</h3>
                    <p class="text-subtitle text-muted">{{ os }} / {{ browser_family }} / {{ browser_version }}</p>
                </div>
                <div class="col-12 col-md-6 order-md-2 order-first">
                    <nav aria-label="breadcrumb" class="breadcrumb-header float-start float-lg-end">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a
                                    href="{% url 'dashboard_secure' request.session.unique_id %}">Dashboard</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Profile View</li>
                        </ol>
                    </nav>
                </div>
            </div>
        </div>
    </div>

    <section class="section">
        <div class="card">
            <div class="card-body">
                <form method="GET" action="{% url 'profile_view_secure' request.session.unique_id %}">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" placeholder="Search by Phone, PMID, or Email"
                            name="search" value="{{ search_query }}">
                        <button class="btn btn-outline-secondary" type="submit">Search</button>
                    </div>
                </form>

                {% if user %}
                <div class="row">
                    <div class="col-12 col-md-6">
                        <h4>Profile Details</h4>
                        <div class="mx-4 mb-3">
                            <img src="https://paraiyarmatching.bumblebeesprojects.in{{ profile.profile_image }}"
                                alt="Profile Image" class="img-fluid rounded mb-3">
                        </div>
                        <p><strong>Age:</strong> {{ profile.age }}</p>
                        <p><strong>Date of Birth:</strong> {{ profile.dob }}</p>
                        <p><strong>Religion:</strong> {{ profile.religion }}</p>
                        <p><strong>Mother Tongue:</strong> {{ profile.mother_tongue }}</p>
                        <p><strong>Height:</strong> {{ profile.height }}</p>
                        <p><strong>Marital Status:</strong> {{ profile.marital_status }}</p>
                        <p><strong>Disability:</strong> {{ profile.disability }}</p>
                        <p><strong>Family Status:</strong> {{ profile.family_status }}</p>
                        <p><strong>Family Type:</strong> {{ profile.family_type }}</p>
                        <p><strong>Family Value:</strong> {{ profile.family_value }}</p>
                        <p><strong>Education:</strong> {{ profile.education }}</p>
                        <p><strong>Employed In:</strong> {{ profile.employed_in }}</p>
                        <p><strong>Occupation:</strong> {{ profile.occupation }}</p>
                        <p><strong>Annual Income:</strong> {{ profile.annual_income }}</p>
                        <p><strong>Work Location:</strong> {{ profile.work_location }}</p>
                        <p><strong>Residing State:</strong> {{ profile.residing_state }}</p>
                        <p><strong>Horoscope URL:</strong> <a href="{{ profile.horoscope_url }}">Horoscope</a></p>
                        <p><strong>My Bio:</strong> {{ profile.my_bio }}</p>
                        <p><strong>Created At:</strong> {{ profile.created_at }}</p>
                        <p><strong>Updated At:</strong> {{ profile.updated_at }}</p>
                    </div>

                    <div class="col-12 col-md-6">
                        <h4>User Details</h4>
                        <p><strong>Name:</strong> {{ user.name }}</p>
                        <p><strong>Email:</strong> {{ user.email }}</p>
                        <p><strong>Phone:</strong> {{ user.phone }}</p>
                        <p><strong>PMID:</strong> {{ user.pmid }}</p>
                        <p><strong>Gender:</strong> {{ user.gender }}</p>
                        <p><strong>Created At:</strong> {{ user.created_at }}</p>
                        <div class="mt-4">
                            <!-- Add buttons to export PDF and edit profile -->
                            <!-- <div>
                                <div>
                                    <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                        data-bs-target="#updateModal" onclick="openUpdateModal('{{ user.pmid }}')">Update
                                        Profile
                                    </button>

                                </div>
                            </div> -->

                        </div>
                    </div>
                </div>

                {% if user_payment %}
                <div class="row mt-4">
                    <div class="col-12">
                        <h4>Payment Details</h4>
                        <p><strong>Package Details:</strong> {{ user_payment.package_details }}</p>
                        <p><strong>Paid Status:</strong>
                            {{ user_payment.paid_status|yesno:"Paid,Not Paid" }}</p>
                        <p><strong>Date of Paid:</strong> {{ user_payment.date_of_paid }}</p>
                        <p><strong>Plan Expired Date:</strong> {{ user_payment.plan_expired_date }}</p>
                    </div>
                </div>
                {% else %}
                <div class="row mt-4">
                    <div class="col-12">
                        <p>No payment details found for this user.</p>
                    </div>
                </div>
                {% endif %}

                {% else %}
                <div class="row">
                    <div class="col-12">
                        <p>No user found. Please enter a valid phone number, PMID, or email ID to search.</p>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </section>

    {% include 'components/footer.html' %}
</div>







{% endblock %}